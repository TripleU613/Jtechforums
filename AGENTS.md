# Repository Guidelines

## Project Structure & Module Organization
- `src/` hosts the React SPA: `components/` shared UI, `pages/` route screens, `context/` providers, `lib/` (Firebase + forum proxy helpers), and `styles/` for Tailwind globals.
- `public/` contains static assets copied verbatim; update favicons and SEO files there.
- `functions/` is a Node 20 Firebase Functions workspace (`functions/index.js`, `.env.*`) powering forum proxy and contact email; run its scripts with `npm --prefix functions`.
- `dist/` is generated by Vite (do not edit), while `dataconnect/` stores schema and seed data for future pipelines; `.github/` automation lives here as well.

## Build, Test, and Development Commands
- `npm install` (root) and `npm install --prefix functions` keep both workspaces in sync.
- `npm run dev` starts the Vite dev server with HMR; API calls assume the Firebase emulator or deployed `/api`.
- `npm run build` compiles to `dist/`, and `npm run preview` serves the build locally to validate rewrites.
- `npm --prefix functions run serve` launches the Functions emulator; `npm --prefix functions run deploy` ships only backend code.
- `npx firebase emulators:start --only hosting,functions` lets you test SPA assets plus `/api/forum/*` and `/api/contact` exactly as production.

## Coding Style & Naming Conventions
- Use functional React components in PascalCase, co-locate helpers, and keep hooks/providers under `src/context`.
- Stick to 2-space indentation, single quotes, trailing semicolons, and descriptive prop names (see `src/components/Footer.jsx`).
- Tailwind is the default styling layer; extend tokens via `tailwind.config.js` and reserve `src/styles/global.css` for resets/utilities.
- Cloud Functions stay CommonJS (`module.exports = { ... }`), async/await, and should validate inputs before touching external APIs.

## Testing Guidelines
- No automated suite ships yet; smoke-test via `npm run preview` and exercise forum/contact flows through the emulator before pushing.
- When you add coverage, prefer Vitest plus React Testing Library and name specs `ComponentName.test.jsx`, colocated with the component.
- Document any manual verification steps in the PR until the automated suite exists.

## Commit & Pull Request Guidelines
- Follow the imperative, descriptive pattern shown in commits `8ef0e50` and `943a586` (e.g., `Refactor scrolling logic on Home page`); avoid vague messages like `103c06f hi`.
- Keep PRs focused, link the relevant issue, include screenshots for visual changes, and mention any Firebase config or secret updates.
- Run `npm run build` and, when Functions change, `npm --prefix functions run serve` before requesting review; note skipped checks explicitly.

## Security & Configuration Tips
- Never commit secrets; mirror required vars in `.env.example` and `functions/.env.example`, and load real values through `firebase functions:secrets:set`.
- Local dev hits the deployed Cloud Run API by default; override `VITE_FORUM_API_BASE_URL` if you need the functions emulator, and set `VITE_FORUM_USE_MOCK` to `auto` or `true` only when you explicitly want mock fixtures.
- When running `firebase emulators:start`, provide `DISCOURSE_API_KEY` (and optional `DISCOURSE_API_USERNAME`/`DISCOURSE_API_BASE`) in `functions/.env.local` so `/api/forum/*` and leaderboard calls succeed locally; otherwise keep `VITE_FORUM_USE_MOCK` unset so the frontend never touches mock payloads.
- Forum traffic should go through `src/lib/forumApi` so the `/api` rewrite works locally and in production; do not hard-code backend URLs.
- Keep SMTP, Discourse, and reCAPTCHA keys scoped to Firebase Secret Manager, and audit `functions/index.js` before enabling new endpoints.
